\begingroup \toks 0={macro:-> \node [state] (S1) {$S_{1}$}; \node [state, right=of S1] (E1) {$E_{1}$}; \node [state, right=of E1] (I1) {$I_{1}$}; \node [state, right=of I1] (R1) {$R_{1}$}; \node [state, below=of S1] (S2) {$S_{2}$}; \node [state, below=of E1] (E2) {$E_{2}$}; \node [state, below=of I1] (I2) {$I_{2}$}; \node [state, below=of R1] (R2) {$R_{2}$}; \coordinate [above=of S1] (in1); \coordinate [above=of R1] (in2); \coordinate [below=of S2] (out1); \coordinate [below=of E2] (out2); \coordinate [below=of I2] (out3); \coordinate [below=of R2] (out4); \draw [every loop] (S1) edge[bend right] node {} (E1) edge[bend right] node {} (S2) (E1) edge[bend right] node {} (I1) edge[bend right] node {} (E2) (I1) edge[bend right] node {} (R1) edge[bend right] node {} (I2) (R1) edge[bend right] node {} (R2) (S2) edge[bend right] node {} (E2) (E2) edge[bend right] node {} (I2) (I2) edge[bend right] node {} (R2) (in1) edge[bend right] node {} (S1) (in2) edge[bend right] node {} (R1) (S2) edge[bend right] node {} (out1) (E2) edge[bend right] node {} (out2) (I2) edge[bend right] node {} (out3) (R2) edge[bend right] node {} (out4) (S1) edge[loop above] node {} (S1) (S2) edge[loop above] node {} (S2) (E1) edge[loop above] node {} (E1) (E2) edge[loop above] node {} (E2) (I1) edge[loop above] node {} (I1) (I2) edge[loop above] node {} (I2) (R1) edge[loop above] node {} (R1) (R2) edge[loop above] node {} (R2); }\xdef \tikzexternallastkey {\the \toks 0 }\endgroup %
