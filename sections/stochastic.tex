\documentclass[../Paper.tex]{subfiles}
\begin{document}
\justifying
Model stochasticity was accomplished through the R package, adaptivetau.
The deterministic differential equations are supplied as a rate function and evaluated
by adaptivetau. Transistions are supplied as a vector and their rates defined by
a rate function. The model is then stepped using a process called
``explicit tau-leaping''\cite{yang_gillespie_petzold_2007}.

This process provides an approximation of the output expected from Gillespie algorithm by maximizing
the time step (called $\tau$) between data points while minimizing the rate of change
of the transition. The resulting output supplies many data points where the rate of
change in a transition is high and sparse data points where the rate
of change is low. This serves a dual purpose:

\begin{enumerate}
  \item[$\bullet$]{To provide vastly superior performance to the Gillespie algorithm}
  \item[$\bullet$]{To introduce model stochasticity by using a random walk variable
                   to define transition advancement}
\end{enumerate}

In making the model stochastic, we can now represent the standard compartmental model
as a markov chain process.

\begin{figure}[htbp]
  \centering
  \begin{tikzpicture}
      % Model States
      \node [state]              (S1) {$S_{1}$};
      \node [state, right=of S1] (E1) {$E_{1}$};
      \node [state, right=of E1] (I1) {$I_{1}$};
      \node [state, right=of I1] (R1) {$R_{1}$};
      \node [state, below=of S1] (S2) {$S_{2}$};
      \node [state, below=of E1] (E2) {$E_{2}$};
      \node [state, below=of I1] (I2) {$I_{2}$};
      \node [state, below=of R1] (R2) {$R_{2}$};
      % In-flows and out-flows
      \coordinate[above=of S1] (in1);
      \coordinate[above=of R1] (in2);
      \coordinate[below=of S2] (out1);
      \coordinate[below=of E2] (out2);
      \coordinate[below=of I2] (out3);
      \coordinate[below=of R2] (out4);
      % Loop connections
      \draw[every loop]
          % Young Compartment
          (S1)   edge[bend right] node {}  (E1)
                 edge[bend right] node {}  (S2)
          (E1)   edge[bend right] node {}  (I1)
                 edge[bend right] node {}  (E2)
          (I1)   edge[bend right] node {}  (R1)
                 edge[bend right] node {}  (I2)
          (R1)   edge[bend right] node {}  (R2)
          % Old Compartment
          (S2)   edge[bend right] node {}  (E2)
          (E2)   edge[bend right] node {}  (I2)
          (I2)   edge[bend right] node {}  (R2)
          % Births
          (in1)  edge[bend right] node {}  (S1)
          (in2)  edge[bend right] node {}  (R1)
          % Deaths
          (S2)   edge[bend right] node {}  (out1)
          (E2)   edge[bend right] node {}  (out2)
          (I2)   edge[bend right] node {}  (out3)
          (R2)   edge[bend right] node {}  (out4)
          % Same state
          (S1) edge[loop above] node {} (S1)
          (S2) edge[loop above] node {} (S2)
          (E1) edge[loop above] node {} (E1)
          (E2) edge[loop above] node {} (E2)
          (I1) edge[loop above] node {} (I1)
          (I2) edge[loop above] node {} (I2)
          (R1) edge[loop above] node {} (R1)
          (R2) edge[loop above] node {} (R2);
  \end{tikzpicture}
  \caption{Markov-chain representation of the SEIR Model}
  \label{fig:M2}
\end{figure}

This serves to highlight the possible transitions between each state per time
step. The ``force'' of the transitions can stil be described in the same way as the
comparmental SEIR Model in Figure \ref{fig:M1}.
However, the probability of any transition per time step is now a function of a
poisson-distributed random walk variable defined in the adaptivetau modelling function.
\begin{equation} \label{eq:tau_leap1}
P\left ( transition \right )\sim Poisson \left( R_{trans}\cdot\tau \right)
\end{equation}
As a consequence, for sufficiently large transition rates ($R_{trans}$) or time steps ($\tau$),
Equation \ref{eq:tau_leap1} can be simplified using the normal distribution:
\begin{equation} \label{eq:tau_leap2}
P\left( transition \right)\sim N \left( R_{trans}\cdot\tau, \sqrt{R_{trans}\cdot\tau} \right)
\end{equation}

\clearpage
\end{document}
